<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="Braulio de AprendeCode">

    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:image" content="">
    <meta property="og:url" content="https://www.aprendecode.com/frontend/">
    <meta property="og:type" content="article">

    <link rel="android-chrome" href="/assets/logo/android-chrome-192x192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/logo/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/logo/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/logo/favicon-16x16.png">
    <link rel="manifest" href="/assets/logo/site.webmanifest">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <link rel="stylesheet" href="/css/style.css">

    <title>¬øC√≥mo utilizar la API Wake Lock con JavaScript?</title>
</head>

<body>
    <my-menu></my-menu>

    <main>
        <section class="header-section header-blog-entry-section">
            <div class="header-container section-container">
                <h1 class="header-title">
                    ¬øC√≥mo utilizar la API Wake Lock con JavaScript?
                </h1>
            </div>
        </section>

        <section class="blog-content-section">
            <div class="blog-content-section-container section-container">
                <p>
                    Excelente t√≠tulo para el blog, pero‚Ä¶ ¬øQu√© es el API Wake Lock? Bueno, con esta API podemos evitar
                    que la pantalla del dispositivo se duerma mientras nuestra aplicaci√≥n est√° en uso. Pongamos ejemplos
                    de su uso: una aplicaci√≥n de mapas, por ejemplo, mientras el usuario sigue la ruta se bloquea la
                    pantalla para evitar que se oscurezca. Otros dos ejemplos ser√≠an un lector de libro digital y una
                    aplicaci√≥n de Pomodoro. Y este √∫ltimo es el ejemplo que veremos en este blog. A continuaci√≥n, te
                    proporcionamos el c√≥digo de partida para que puedas copiarlo en tu editor, comprobarlo y seguir los
                    pasos junto conmigo.
                </p>

                <h2>C√≥difo de Partida: HTML y CSS</h2>

                <div class="snippets">
                    <div class="snippet">
                        <button class="copy-button" data-copy-target="#snippet1">Copiar</button>
                        <pre>
                           <code id="snippet1" class="language-html">
                
                           </code>
                        </pre>
                    </div>
                    <div class="snippet">
                        <button class="copy-button" data-copy-target="#snippet2">Copiar</button>
                        <pre>
                           <code id="snippet2" class="language-css"> </code>
                        </pre>
                    </div>
                </div>

                <h2>C√≥difo de Partida: JavaScript</h2>

                <div class="snippets">
                    <div class="snippet snippet-alone">
                        <button class="copy-button" data-copy-target="#snippet3">Copiar</button>
                        <pre>
                           <code id="snippet3" class="language-javascript">
                           
                           </code>
                        </pre>
                    </div>
                </div>

                <h2>¬°Explicando el c√≥digo!</h2>
                <p>
                    Ahora, explicando un poquito el c√≥digo, en el HTML y el CSS no creo que sea necesario explicar nada,
                    ya que son estilos comunes. En el JavaScript ya tenemos preparado un temporizador con 5 segundos por
                    defecto. Lo que estamos haciendo es que al hacer clic en el bot√≥n Start (comenzar), se activa el
                    temporizador y cada vez que llega a cero, se detiene y se reinicia.
                </p>
                <p>
                    En realidad, no hay mucho m√°s que explicar. Sin embargo, antes de utilizar esta API, es importante
                    tener en cuenta que mantener el dispositivo despierto en todo momento mientras se utiliza nuestra
                    aplicaci√≥n, afecta el consumo de la bater√≠a. Por lo tanto, es recomendable utilizarlo solo cuando
                    sea necesario. En este caso, vamos a hacer uso de esta API siempre y cuando est√© activado el
                    temporizador. As√≠ que el primer paso es declarar la funci√≥n encargada de hacer la petici√≥n de
                    bloqueo.
                </p>

                <h2>Petici√≥n de bloqueo de pantalla - API Wake Lock</h2>
                <p>
                    Primero, voy a declarar una variable en el √°mbito global que utilizar√© tanto para bloquear como para
                    desbloquear la pantalla. La llamar√© igual que esta API, es decir, wakeLock y le asignar√© un valor
                    nulo (let wakeLock = null). Luego, declararemos la funci√≥n encargada de hacer la petici√≥n de bloqueo
                    que llamaremos solicitarBloqueoPantalla(). Es importante tener en cuenta que esta funci√≥n debe ser
                    as√≠ncrona ya que necesitamos hacer una petici√≥n al navegador, pero es necesario esperar por su
                    respuesta antes de continuar. Para declarar la funci√≥n como as√≠ncrona, solo necesitamos utilizar la
                    palabra clave async antes de la declaraci√≥n. Antes de hacer la petici√≥n de bloqueo, utilizaremos la
                    palabra clave await que, traducida al espa√±ol, significa esperar. De este modo, le estamos diciendo
                    al programa que es necesario esperar por la respuesta del navegador antes de continuar. Es
                    importante tener en cuenta que esto se puede ver en el c√≥digo que se encuentra debajo.
                </p>
                <p>
                    Antes de continuar quer√≠a dejarte saber que ya tenemos listo el tutorial sobre el API Wake Lock en
                    nuestro canal de YouTube y te lo dejo por üëâüëâ
                    <a href="https://www.youtube.com/watch?v=Lz5zTIOnzrc" target="_blank"
                        rel="noopener noreferrer">AQU√ç</a> üëàüëà
                </p>

                <h2>Captura de errores en la petici√≥n</h2>
                <p>
                    Ahora, dentro vamos a utilizar un try catch por si tenemos alg√∫n error poder capturarlo. Entonces,
                    vamos a hacer la petici√≥n en el bloque try. Ser√≠a: wakeLock = await
                    navigator.wakeLock.request(‚Äòscreen‚Äô). Primero que todo ponemos la palabra clave await, despu√©s
                    mencionamos el objeto navigator (navegador) luego, la propiedad wakeLock dentro de este objeto y por
                    √∫ltimo, hacemos uso del m√©todo request() pas√°ndole el valor screen, ya que es este el cual solicita
                    el bloqueo de la pantalla. Agregamos un console.log que diga que la pantalla se ha bloqueado y otro
                    para mostrar en consola la variable wakeLock porque luego quiero mostrarte algo. Y en la parte del
                    catch hacemos console.error que diga que tenemos un error y le pasamos el error que se ha capturado.
                    Ahora, ¬øDesde d√≥nde voy a llamar esta funci√≥n? Pues cuando se activa el temporizador, vamos a
                    hacerlo despu√©s de inicializar las variables. Aqu√≠ abajo te voy a dejar el c√≥digo completo con este
                    cambio implementado. Primero la funci√≥n comenzarTemporizador y de segunda la funci√≥n que se encarga
                    de hacer la petici√≥n de bloqueo (solicitarBloqueoPantalla()).
                </p>

                <div class="snippets">
                    <div class="snippet snippet-alone">
                        <button class="copy-button" data-copy-target="#snippet4">Copiar</button>
                        <pre>
                           <code id="snippet4" class="language-javascript">
                           
                           </code>
                        </pre>
                    </div>
                </div>

                <h2>¬øC√≥mo desbloquear la pantalla?</h2>
                <p>
                    Si haces clic en el bot√≥n Start y no tenemos ning√∫n bug (error) por ah√≠ escondido, deber√≠a hacer la
                    petici√≥n de bloqueo perfectamente. Como te mencion√© anteriormente, esto afecta la duraci√≥n de la
                    bater√≠a del dispositivo, as√≠ que en cuanto se detenga el temporizador, necesitamos hacer la petici√≥n
                    de desbloqueo. Ahora, necesito que vayas a la consola y ver√°s que en cuanto se hace la petici√≥n de
                    bloqueo, sale un mensaje diciendo que la pantalla ha sido bloqueada y adem√°s, la variable wakeLock
                    que ahora mismo almacena el objeto devuelto en la petici√≥n de bloqueo. Dentro de ella, notar√°s que
                    hay una propiedad llamada released con el valor false. Pues esta propiedad es la que indica si la
                    pantalla est√° bloqueada o no. Released en espa√±ol significa liberado, o sea que si su valor es false
                    como es en este caso, eso indica que la pantalla est√° bloqueada. Para desbloquear la pantalla, vamos
                    a utilizar el m√©todo release(), ya que este modifica el valor inicial de la propiedad released a
                    true, indicando que ahora est√° desbloqueada (liberada).
                </p>

                <h2>M√©todo release() - API Wake Lock</h2>

                <p>
                    Ahora vamos a declarar la funci√≥n para desbloquear la pantalla y esta tambi√©n es as√≠ncrona. Vamos a
                    llamarla desbloquearPantalla() y puedes ver el c√≥digo completo abajo mientras lees para que te sea
                    m√°s f√°cil de entender. Dentro, otra vez utilizaremos un try catch para capturar y manejar
                    adecuadamente los errores. En el bloque try, lo primero que hacemos es hacer la petici√≥n de
                    desbloqueo de este modo await wakeLock.release(). Luego pasamos un mensaje por la consola indicando
                    que la pantalla se ha desbloqueado, tambi√©n pasamos por la consola la variable wakeLock para que
                    puedas ver c√≥mo se modifica el valor inicial de la propiedad released de false a true. Por √∫ltimo,
                    devolvemos a la variable wakeLock su valor inicial de null. En el bloque catch solo agregamos un
                    console.error y pasamos un mensaje especificando el error. Esta funci√≥n la llamaremos dentro del if
                    donde se limpia el intervalo. El c√≥digo completo hasta este punto est√° a continuaci√≥n. Recuerda que
                    la funci√≥n desbloquearPantalla() es la √∫ltima en el c√≥digo.
                </p>

                <div class="snippets">
                    <div class="snippet snippet-alone">
                        <button class="copy-button" data-copy-target="#snippet5">Copiar</button>
                        <pre>
                           <code id="snippet5" class="language-javascript">
                           
                           </code>
                        </pre>
                    </div>
                </div>

                <h2>Comprobar Compatibilidad - API Wake Lock</h2>
                <p>
                    Realmente ya estar√° funcionando perfectamente el bloqueo y desbloqueo, pero siempre es sumamente
                    importante comprobar la compatibilidad de esta API en el navegador en el cual se va a utilizar.
                    Realmente, el √∫nico navegador que no es compatible con esta API (hasta el momento) es Firefox. Pero
                    bueno, nosotros estamos conscientes del navegador que utilizamos en nuestro ordenador, pero no del
                    que utiliza el usuario. As√≠ que siempre es necesario comprobar la compatibilidad antes de hacer
                    cualquier petici√≥n. Esto lo he dejado para el final porque es la parte m√°s sencilla de implementar a
                    nuestro c√≥digo. Para este ejemplo, vamos a declarar una funci√≥n llamada comprobarCompatibilidad() y
                    dentro colocamos una condici√≥n que diga if (‚ÄòwakeLock‚Äô in navigator), que siempre que el navegador
                    sea compatible con el API Wake Lock, entonces que haga la petici√≥n de bloqueo. En la parte falsa, es
                    decir, en caso de que no sea compatible, mostramos un mensaje por la consola diciendo que el
                    navegador no es compatible con esta API. Aqu√≠ abajo puedes ver esta funci√≥n terminada.
                </p>

                <div class="snippets">
                    <div class="snippet snippet-alone">
                        <button class="copy-button" data-copy-target="#snippet6">Copiar</button>
                        <pre>
                           <code id="snippet6" class="language-javascript">
                           
                           </code>
                        </pre>
                    </div>
                </div>

                <p>
                    Ahora solo tenemos que hacer un peque√±o cambio. A la hora de hacer la petici√≥n de bloqueo, en vez de
                    llamar directamente a la funci√≥n encargada de hacer dicha petici√≥n (solicitarBloqueoPantalla),
                    llamamos a la funci√≥n que verifica la compatibilidad. Entonces, esta se encargar√° de llamar a la
                    funci√≥n encargada de hacer la solicitud, pero siempre y cuando el navegador sea compatible con esta
                    API. Aqu√≠ abajo te voy a dejar el c√≥digo completo hasta este punto para que lo copies, lo pruebes en
                    tu propio editor y veas su funcionamiento.
                </p>

                <div class="snippets">
                    <div class="snippet snippet-alone">
                        <button class="copy-button" data-copy-target="#snippet7">Copiar</button>
                        <pre>
                           <code id="snippet7" class="language-javascript">
                           
                           </code>
                        </pre>
                    </div>
                </div>

                <h2>Despedida</h2>
                <p>
                    ¬°Eso es todo por hoy, queridos coders y codigo-lovers! Espero que hayan disfrutado de este blog y
                    que hayan aprendido algo valioso sobre el API Wake Lock. Si tienen alguna duda o necesitan ayuda
                    adicional, no duden en ponerse en contacto conmigo. Siempre estoy aqu√≠ para ayudarles en todo lo que
                    necesiten. Muchas gracias por leer y seguir mi contenido en este blog, y espero verlos pronto en
                    pr√≥ximas publicaciones. ¬°Hasta la pr√≥xima! Nos leemos en el siguiente.
                </p>
                <p>¬°Un Abrazo! Braulio de AprendeCode</p>





            </div>
        </section>
    </main>

    <my-footer></my-footer>

    <script src="/js/components/menu.js"></script>
    <script rel="preload" src="/js/components/footer.js" as="script"></script>
    <script rel="preload" src="/js/entries.js" as="script"></script>
    <script>
        const entryName = 'nueva-entrada';
        const totalSnippets = 7;
        fetchAndDisplayCodeSnippets(entryName, totalSnippets);
    </script>
</body>

</html>